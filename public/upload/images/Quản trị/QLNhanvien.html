<!DOCTYPE html>
<html>
<title>Quản lý nhân viên</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="../style/style.css">
<link rel="stylesheet" href="../style/main_ index.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://kit.fontawesome.com/e06076012c.js" crossorigin="anonymous"></script>
<script src="js/java_jqu.js"></script>
<body>
    <!-- Sidebar -->
    <section class="header">
        <a href="javascript:void(0);" class="icon" onclick="openBTN()">
            <i class="fas fa-bars"></i>
        </a>
        <div class="box-login" id="box-t">
            Xin chào, <span id="tenkhachhang">Admin</span><i class="fas fa-sort-down"></i>
            <div class="box-login-bottom" id="box-b">
                <button onclick="trangchu()"><i class="fas fas fas fa-reply"></i>Vào trang web</button>
                <button onclick="TTTaiKhoan()"><i class="fas fa-user-alt"></i> Tài khoản</button>
                <button onclick="LogOut();"><i class="fas fa-sign-out-alt"></i> Đăng xuất</button>
            </div>
        </div>
    </section>
    <section class="main">
        <div class="row">
            <div class="col-2 col-s-12 category">
                <div class="bgbtn"></div>
                <a href="../index.html"><i class="fa fa-reply" aria-hidden="true"></i>Trang quản trị</a>
                <a href="../Quản trị/QLsanpham.html"><i class="fas fa-barcode"></i> Sản phẩm</a>
                <a href="../Quản trị/QLLoaisanpham.html"><i class="fas fa-boxes"></i> Loại sản phẩm</a>
                <a href="../Quản trị/QL nhacungcap.html"><i class="fas fa-truck"></i> Nhà cung cấp</a>
                <a href="../Quản trị/QLNhanvien.html"><i class="fas fa-user"></i> Nhân viên</a>
                <a href="../Quản trị/QLHoadonnhap.html"><i class="fas fa-file-import"></i> Hóa đơn nhập</a>
                <a href="../Quản trị/QLHoadonban.html"><i class="fas fa-shopping-cart"></i> Hóa đơn bán</a>
        </div>
        <div class="col-10 col-s-12 content">
            <div class="col-12 col-s-12 content">
            <form style="margin-left: -20px;">
                <div class="wraps">Nhập thông tin nhân viên</div>
            <div class="wrap-field">
                <label for="">Mã nhân viên : </label>
                <div class="col-12 col-s-12">
                    <input type="text" name="" placeholder="Nhập mã nhân viên..." id="Product"required>
                </div>
            </div>
            <div class="wrap-field">
                <label for=""> Tên nhân viên : </label>
               <div class="col-12 col-s-12">
                <input type="text" name="" placeholder="Nhập tên nhân viên..." id="name"required>
               </div>
            </div>
            <div class="wrap-field">
                    <label for="">Ảnh nhân viên : </label>
                    <div class="col-12 col-s-12">
                       <input type="file" name="" id="image">
                    </div>
                </div>
            <div class="wrap-field">
                <label for="">Số điện thoại : </label>
               <div class=" col-12 col-s-12">
                <input type="text" name="" placeholder="Nhập số điện thoại nhân viên..." id="sdt"required>
               </div>
            </div>
            <div class="wrap-field">
                <label for="">Địa chỉ : </label>
               <div class="col-12 col-s-12">
                <input type="text" name="" placeholder="Nhập địa chỉ nhân viên..." id="diachi"required>
               </div>
            </div>
            <div class="wrap-field">
                    <label for="txt_email">Email <span style="color: red;" id="s_email">*</span></label><br>
                   <div class="col-12 col-s-12">
                    <input type="text" name="" placeholder="Nhập Email..." id="mail"required>
                   </div>
                </div>
                <div class="wrap-field">
                    <label for="txt_email">Mật Khẩu <span style="color: red;" id="s_mk">*</span></label><br>
                   <div class="col-12 col-s-12">
                    <input type="password" name="" placeholder="Nhập mật khẩu..." id="mk"required>
                   </div>
                </div>
                <div class=" wrap-field">
                    <label for="">Quyền :</label>
                    <select class="col-12 col-s-12 option" id="quyen"required>
                        <option>--Select--</option>
                        <option value="Quản lý">Quản lý</option>
                        <option value="Nhân viên">Nhân viên</option>   
                    </select>
                </div>
            <div class="wrap">
                <input onclick="Addnhanvien()" type="submit" value="Add">
                <input onclick="reset()" type="submit" value="Reset">
                <input id="sua" type="submit"  value="Edit">
            </div>
            </form>
   <div class=" col-12 col-s-12 float_right">
        <div class="warps1">Danh sách nhân viên</div>
             <div class="search">
                    <input type="text" name="" id="mynv" placeholder="Search...">
             </div>
            <table cellspacing="0">
                <tr style="background-color: rgb(13, 167, 46);height: 50px;">
                    <th>Mã NV</th>
                    <th>Tên NV</th>
                    <th>Ảnh</th>
                    <th>SĐT</th>
                    <th>Địa chỉ</th>
                    <th>Email</th>
                    <th>Quyền</th>
                    <th>Mật Khẩu</th>
                    <th>Tác vụ</th>
                </tr>
                <tbody id="mynhanvien">
                </tbody>
            </table>
        </div>
    </div>
   <script>
        function Addnhanvien()
        {
            var arr=document.getElementsByTagName('input');
            var arrr=document.getElementsByTagName('select');
            var Product=arr[0].value;
            var name=arr[1].value;
            var image=arr[2].files[0].name;
            var sdt=arr[3].value;
            var diachi=arr[4].value;
            var mail=arr[5].value;
            var quyen=arrr[0].value;
            var mk=arr[6].value;

            if(Product.length>10)
            {
                        alert("Mã nhân viên không hợp lệ.Mời nhập lại mã ! ");
                        return;
            }
            if(name.length>50)
            {
                        alert("Tên nhân viên không hợp lệ.Mời nhập lại !")
                        return;
            }      
             if(sdt.length!=10||isNaN(sdt)) 
            {
                        alert("Số điện thoại không hợp lệ.Vui lòng nhập lại");
                        return;
            }
            if(diachi.length>50)
            {
                        alert("Địa chỉ không hợp lệ.Vui lòng nhập lại")
                        return;
            }
    
            var Listnv = JSON.parse(localStorage.getItem('QLnhanviens'));
            if (Listnv == null) Listnv = [];
            var QLnhanviens = {
                Product: Product,
                name: name,
                image: image,
                sdt: sdt,
                diachi: diachi,
                mail: mail,
                quyen: quyen,
                mk:mk
            };
            Listnv.push(QLnhanviens)
            localStorage.setItem('QLnhanviens', JSON.stringify(Listnv))
            alert("Thêm nhân viên thành công !")
            location.reload();
        }
        var list1 = JSON.parse(localStorage.getItem('QLnhanviens'));
        function Loadnv()
        {
            var str = "";
            for (x of list1) {
                str += `<tr>
                        <td>`+ x.Product+ `</td>
                        <td>`+ x.name + `</td>
                        <td><img src='../image/`+ x.image + `' /></td>
                        <td>`+ x.sdt + `</td>
                        <td>`+ x.diachi + `</td>
                        <td>`+ x.mail + `</td>
                        <td>`+ x.quyen + `</td>
                        <td>`+ x.mk + `</td>
                        <td ><i onclick="Edit(event)" class="fa fa-pencil-square-o" aria-hidden="true"></i> <i onclick="Xoa(`+ x.Product + `)" class="fa fa-trash-o" aria-hidden="true"></i></td>
                    </tr>
                `;
            }
            document.getElementById("mynhanvien").innerHTML = str;
        }
        Loadnv();
        function resetall() {
            document.getElementsByTagName('form')[0].reset()
        }
      
        function Xoa(Product) {
            var index = list1.findIndex(x => x.Product == Product);
            if (index >= 0) {
                list1.splice(index, 1);
            }
            localStorage.setItem('QLnhanviens', JSON.stringify(list1));
            Loadnv();  
        }
        $(document).ready(function(){
            $("#mynv").on("keyup", function() {
            var value = $(this).val().toLowerCase();
            $("#mynhanvien tr").filter(function() {
                $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
            });
            });
        });
        function Edit(event) {
            var parent = event.target.parentElement.parentElement.children[0]; 
            console.log(parent.innerText);
            var list1 = JSON.parse(localStorage.getItem('QLnhanviens'));
            for(let i=0;i<list1.length;i++){
                if(list1[i].Product==parent.innerText.trim()){
            document.getElementById('Product').value=list1[i].Product;
            document.getElementById('name').value=list1[i].name;
            document.getElementById('image').files.name=list1[i].image; 
            document.getElementById('sdt').value=list1[i].sdt;
            document.getElementById('diachi').value=list1[i].diachi; 
            document.getElementById('mail').value=list1[i].mail;
            document.getElementById('quyen').value=list1[i].quyen;
            document.getElementById('mk').value=list1[i].quyen;
            break;
                }
            }
            document.getElementById('sua').addEventListener('click',e=>{
                for(let i=0;i<list1.length;i++){
                if(list1[i].Product==parent.innerText.trim()){
                    list1[i].Product = document.getElementById('Product').value;
                    list1[i].name = document.getElementById('name').value;
                    if(document.getElementById('image').files[0])
                    list1[i].image = document.getElementById('image').files[0].name;
                    list1[i].sdt= document.getElementById('sdt').value;
                    list1[i].diachi=  document.getElementById('diachi').value;
                    list1[i].mail= document.getElementById('mail').value;
                    list1[i].quyen= document.getElementById('quyen').value;
                    document.getElementById('mk').value=list1[i].quyen;
                    localStorage.setItem('QLnhanviens',JSON.stringify(list1));
                     break;
                }    
            }
            document.getElementById('Product').value='';
            document.getElementById('name').value='';
            document.getElementById('image').value='';
            document.getElementById('sdt').value=''; 
            document.getElementById('diachi').value='';
            document.getElementById('quyen').value='';
            document.getElementById('mk').value='';
            Loadnv();
            })
        }
        nameKH();
   </script>
    <!-- Page Content -->
    
</body>
</html>